# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∫–æ–Ω–æ–∫ –æ—á–µ—Ä–µ–¥–∏ (–∂–µ–ª—Ç—ã–π –∫—Ä—É–≥ —Å —á–∞—Å–∞–º–∏) –Ω–∞ –≤–∫–ª–∞–¥–∫–∞—Ö

## –ü—Ä–æ–±–ª–µ–º–∞
–ò–∫–æ–Ω–∫–∏ –æ—á–µ—Ä–µ–¥–∏ (üü°‚è∞) –Ω–∞ –≤–∫–ª–∞–¥–∫–∞—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä—ã –∏—Å—á–µ–∑–∞–ª–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –±—ç–∫–µ–Ω–¥–∞.

## –ü—Ä–∏—á–∏–Ω–∞
1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç –º–æ–¥–µ–ª–∏ –≤ –±—ç–∫–µ–Ω–¥–µ** - `from app.models.queue import QueueEntry` (—Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ hasActiveQueue** - –ø—Ä–æ–≤–µ—Ä—è–ª—Å—è —Å—Ç–∞—Ç—É—Å `'queued'` –≤–º–µ—Å—Ç–æ –Ω–∞–ª–∏—á–∏—è `queue_numbers`

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ë—ç–∫–µ–Ω–¥: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç QueueEntry
**–§–∞–π–ª:** `c:\final\backend\app\api\v1\endpoints\registrar_integration.py`
**–°—Ç—Ä–æ–∫–∞:** 1218

```python
# ‚ùå –ë–´–õ–û (—Ñ–∞–π–ª queue.py –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç):
from app.models.queue import QueueEntry

# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û:
from app.models.queue_old import QueueEntry
```

**–≠—Ñ—Ñ–µ–∫—Ç:** –ë—ç–∫–µ–Ω–¥ —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ –æ—á–µ—Ä–µ–¥–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `queue_entries`.

---

### 2. –§—Ä–æ–Ω—Ç–µ–Ω–¥: –ü—Ä–æ–≤–µ—Ä–∫–∞ queue_numbers –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ç—É—Å–∞
**–§–∞–π–ª:** `c:\final\frontend\src\pages\RegistrarPanel.jsx`
**–°—Ç—Ä–æ–∫–∞:** 2356-2357

```javascript
// ‚ùå –ë–´–õ–û:
hasActiveQueue: deptAppointments.some(a => a.status === 'queued')

// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û:
hasActiveQueue: deptAppointments.some(a => a.queue_numbers && a.queue_numbers.length > 0)
```

**–≠—Ñ—Ñ–µ–∫—Ç:** –ò–∫–æ–Ω–∫–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π —Å `queue_numbers`, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞.

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- 261 –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ `queue_entries`
- 22 –≤–∏–∑–∏—Ç–∞ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏ –æ—á–µ—Ä–µ–¥–∏ (1-4)

### ‚úÖ API
- –í—Å–µ 6 –æ—Ç–¥–µ–ª–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∑–∞–ø–∏—Å–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏:
  - –î–µ—Ä–º–∞—Ç–æ–ª–æ–≥–∏—è: 4 –∑–∞–ø–∏—Å–∏ (‚Ññ1-4)
  - –ö–∞—Ä–¥–∏–æ–ª–æ–≥–∏—è: 3 –∑–∞–ø–∏—Å–∏ (‚Ññ1-3)
  - –°—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—è: 3 –∑–∞–ø–∏—Å–∏ (‚Ññ1-3)
  - –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è: 4 –∑–∞–ø–∏—Å–∏ (‚Ññ1-4)
  - –ü—Ä–æ—Ü–µ–¥—É—Ä—ã: 4 –∑–∞–ø–∏—Å–∏ (‚Ññ1-4)
  - –≠–ö–ì: 4 –∑–∞–ø–∏—Å–∏ (‚Ññ1-4)

### ‚úÖ –õ–æ–≥–∏–∫–∞ hasActiveQueue
- –í—Å–µ 6 –æ—Ç–¥–µ–ª–æ–≤ –∏–º–µ—é—Ç `hasActiveQueue = true`
- –ò–∫–æ–Ω–∫–∏ üü°‚è∞ –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –Ω–∞ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–∫–∞—Ö

---

## –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ò–∫–æ–Ω–∫–∏ –æ—á–µ—Ä–µ–¥–∏ (–∂–µ–ª—Ç—ã–π –∫—Ä—É–≥ —Å —á–∞—Å–∞–º–∏) –¥–æ–ª–∂–Ω—ã:**
- ‚úÖ –ü–æ—è–≤–ª—è—Ç—å—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ (–Ω–µ —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö)
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤–æ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–∫–∞—Ö —Å –∑–∞–ø–∏—Å—è–º–∏ –≤ –æ—á–µ—Ä–µ–¥–∏
- ‚úÖ –û—Å—Ç–∞–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã (F5)
- ‚úÖ –û—Å—Ç–∞–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –±—ç–∫–µ–Ω–¥–∞
- ‚úÖ –û—Å—Ç–∞–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –∏–∑ —Å–Ω–∞

---

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

1. **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –±—ç–∫–µ–Ω–¥:**
   ```bash
   cd c:\final\backend
   # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (Ctrl+C)
   # –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:
   uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
   ```

2. **–û–±–Ω–æ–≤–∏—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥:**
   - –ù–∞–∂–º–∏—Ç–µ F5 –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev server:
   ```bash
   cd c:\final\frontend
   npm run dev
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–∫–æ–Ω–∫–∏:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä—ã
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–∞ –≤–∫–ª–∞–¥–∫–∞—Ö (–ö–∞—Ä–¥–∏–æ–ª–æ–≥, –î–µ—Ä–º–∞—Ç–æ–ª–æ–≥, –∏ —Ç.–¥.) –ø–æ—è–≤–∏–ª–∏—Å—å –∂–µ–ª—Ç—ã–µ –∫—Ä—É–∂–∫–∏ —Å —á–∞—Å–∞–º–∏
   - –ù–∞–≤–µ–¥–∏—Ç–µ –∫—É—Ä—Å–æ—Ä - –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å—Å—è tooltip "–í –æ—á–µ—Ä–µ–¥–∏: N"

4. **–¢–µ—Å—Ç –Ω–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å:**
   - –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É (F5) - –∏–∫–æ–Ω–∫–∏ –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞—Ç—å—Å—è
   - –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –±—ç–∫–µ–Ω–¥ - –∏–∫–æ–Ω–∫–∏ –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞—Ç—å—Å—è
   - –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏ - –∏–∫–æ–Ω–∫–∏ –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞—Ç—å—Å—è

---

## –¢–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

–°–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

1. **check_queue_icons.py** - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ
2. **test_queue_icons_api.py** - –ü—Ä–æ–≤–µ—Ä–∫–∞ API endpoint
3. **test_full_queue_icons.py** - –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –æ—Ç –ë–î –¥–æ API
4. **test_queue_badge.py** - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ hasActiveQueue

–ó–∞–ø—É—Å–∫:
```bash
cd c:\final
python -X utf8 check_queue_icons.py
python -X utf8 test_queue_badge.py
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –∏–∫–æ–Ω–∫–∏

1. **–ë—ç–∫–µ–Ω–¥** (`registrar_integration.py:1215-1240`):
   - –ó–∞–ø—Ä–æ—Å –∫ `queue_entries` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞
   - –í–æ–∑–≤—Ä–∞—Ç `number` –≤ JSON –æ—Ç–≤–µ—Ç–µ

2. **–§—Ä–æ–Ω—Ç–µ–Ω–¥** (`RegistrarPanel.jsx:1221-1229`):
   - –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ `queue_numbers` —Å `queue_name` –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ state `appointments`

3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** (`RegistrarPanel.jsx:2342-2362`):
   - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ `departmentStats` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Ç–¥–µ–ª–∞
   - `hasActiveQueue` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ `queue_numbers`

4. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫** (`ModernTabs.jsx:136-146`):
   - –ü–æ–ª—É—á–∞–µ—Ç `departmentStats` –∫–∞–∫ props
   - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∏–∫–æ–Ω–∫—É —á–∞—Å–æ–≤ –µ—Å–ª–∏ `hasActiveQueue === true`

---

## Mapping –æ—Ç–¥–µ–ª–æ–≤

–ë—ç–∫–µ–Ω–¥ ‚Üí –§—Ä–æ–Ω—Ç–µ–Ω–¥:
- `cardiology` ‚Üí `cardio`
- `dermatology` ‚Üí `derma`
- `dentistry/stomatology` ‚Üí `dental`
- `laboratory` ‚Üí `lab`
- `procedures` ‚Üí `procedures`
- `echokg/ecg/–≠–ö–ì` ‚Üí `echokg`

–ú–∞–ø–ø–∏–Ω–≥ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ `isInDepartment()` (—Å—Ç—Ä–æ–∫–∏ 2304-2317).

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ –∏–∫–æ–Ω–∫–∏ –≤—Å—ë –µ—â—ë –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±—ç–∫–µ–Ω–¥ –ª–æ–≥–∏ –Ω–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `queue_entries` —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ (SQL: `SELECT COUNT(*) FROM queue_entries`)

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 2025-11-04
**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:**
- `backend/app/api/v1/endpoints/registrar_integration.py` (—Å—Ç—Ä–æ–∫–∞ 1218)
- `frontend/src/pages/RegistrarPanel.jsx` (—Å—Ç—Ä–æ–∫–∞ 2357)
