# üîí AI Architecture Rule - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ

```
AI –≤—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ useEMRAI / mcpClient.
UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∑–Ω–∞—é—Ç –ø—Ä–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤.
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    UI LAYER (UI-only)                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  EMRSmartField  ‚îÇ  ICD10Autocomplete  ‚îÇ  AISuggestions      ‚îÇ
‚îÇ       ‚îÇ                  ‚îÇ                    ‚îÇ             ‚îÇ
‚îÇ  suggestions: []    suggestions: []     suggestions: []     ‚îÇ
‚îÇ  loading: bool      loading: bool       onSelect: fn        ‚îÇ
‚îÇ  onSearch: fn       onSearch: fn                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚îÇ props (suggestions, loading, callbacks)
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    HOOK LAYER                               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                      useEMRAI                               ‚îÇ
‚îÇ   - icd10Suggestions                                        ‚îÇ
‚îÇ   - loading                                                 ‚îÇ
‚îÇ   - getICD10Suggestions(symptoms, diagnosis, specialty)     ‚îÇ
‚îÇ   - analyzeComplaints(...)                                  ‚îÇ
‚îÇ   - interpretLabResults(...)                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚îÇ calls mcpAPI
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    API LAYER                                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                      mcpClient                              ‚îÇ
‚îÇ   - suggestICD10({ symptoms, diagnosis, provider })         ‚îÇ
‚îÇ   - analyzeComplaint({ complaint, patientAge, provider })   ‚îÇ
‚îÇ   - interpretLabResults({ results, provider })              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚îÇ HTTP POST /api/v1/mcp/*
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    BACKEND MCP                              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  icd10_server  ‚îÇ  complaint_server  ‚îÇ  lab_server          ‚îÇ
‚îÇ       ‚îÇ                  ‚îÇ                  ‚îÇ               ‚îÇ
‚îÇ       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îÇ
‚îÇ                          ‚ñº                                  ‚îÇ
‚îÇ               AI Manager (DeepSeek ‚Üí Gemini ‚Üí OpenAI)       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã

### 1. ICD10Autocomplete (UI-only)

```jsx
// ICD10Autocomplete.jsx - UI-only component
const ICD10Autocomplete = ({
  suggestions = [],      // –ü–æ–ª—É—á–∞–µ–º –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è
  loading = false,       // –ü–æ–ª—É—á–∞–µ–º –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è  
  onSearch,              // Callback –≤ —Ä–æ–¥–∏—Ç–µ–ª—è
  onChange
}) => {
  // ‚ùå –ù–ï–¢: const result = await api.post('/ai/icd-suggest')
  // ‚ùå –ù–ï–¢: const { searchICD } = useICDSuggestions()
  
  // ‚úÖ –î–ê: –ü—Ä–æ—Å—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º suggestions
  return (
    <Dropdown>
      {suggestions.map(s => <Item key={s.code} />)}
    </Dropdown>
  );
};
```

### 2. Parent Component (—Å useEMRAI)

```jsx
// SingleSheetEMR.jsx
import { useEMRAI } from '../../hooks/useEMRAI';

const SingleSheetEMR = () => {
  // AI —á–µ—Ä–µ–∑ hook
  const { icd10Suggestions, loading, getICD10Suggestions } = useEMRAI(true, 'deepseek');

  return (
    <ICD10Autocomplete
      suggestions={icd10Suggestions}
      loading={loading}
      onSearch={(query) => getICD10Suggestions(complaints, query)}
    />
  );
};
```

### 3. EMRSmartField (—Å –≤–Ω–µ—à–Ω–∏–º–∏ templates)

```jsx
// EMRSmartField - –ø–æ–ª—É—á–∞–µ—Ç suggestions –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è
<EMRSmartField
  onRequestAI={mockEMRTemplates}  // Callback, –Ω–µ –ø—Ä—è–º–æ–π API
  // –í–Ω—É—Ç—Ä–∏ EMRSmartField –≤—ã–∑—ã–≤–∞–µ—Ç onRequestAI, –Ω–µ api –Ω–∞–ø—Ä—è–º—É—é
/>
```

---

## ‚ùå –ó–ê–ü–†–ï–©–ï–ù–û

```jsx
// –í UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
import { api } from '../../api/client';
import { mcpAPI } from '../../api/mcpClient';

// –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ API –≤–Ω—É—Ç—Ä–∏ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
const result = await api.post('/ai/icd-suggest', data);
const mcpResult = await mcpAPI.suggestICD10(data);
```

---

## üìÅ –§–∞–π–ª—ã

| –§–∞–π–ª | –¢–∏–ø | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-----|------------|
| `useEMRAI.js` | Hook | –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ç–æ—á–∫–∞ –≤—ã–∑–æ–≤–∞ AI |
| `mcpClient.js` | API Client | HTTP –≤—ã–∑–æ–≤—ã –∫ MCP backend |
| `ICD10Autocomplete.jsx` | UI-only | –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ |
| `AISuggestions.jsx` | UI-only | –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–¥—Å–∫–∞–∑–æ–∫ |
| `EMRSmartField.jsx` | UI-only | Ghost text, modes |

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞** ‚Äî –≤—Å–µ AI —á–µ—Ä–µ–∑ useEMRAI
2. **–õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** ‚Äî mock useEMRAI –≤ —Ç–µ—Å—Ç–∞—Ö
3. **–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã —Å–∫—Ä—ã—Ç—ã** ‚Äî UI –Ω–µ –∑–Ω–∞–µ—Ç –ø—Ä–æ DeepSeek/Gemini
4. **Fallback –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π** ‚Äî –≤ useEMRAI
5. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –≤ hook, –Ω–µ –≤ –∫–∞–∂–¥–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ

---

## –ß–µ–∫–ª–∏—Å—Ç —Ä–µ–≤—å—é

–ü—Ä–∏ code review –ø—Ä–æ–≤–µ—Ä—è–π:

- [ ] UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ù–ï –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `mcpClient` –∏–ª–∏ `api`
- [ ] AI –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `useEMRAI` –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
- [ ] Suggestions –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ props
- [ ] Loading state –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ props
- [ ] onSearch callback –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ useEMRAI

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2026-01-05  
